import xlsxwriter

def generate_test_data():
    return {
      'id': 'g_1_CvbDaBsg', 'game_link': 'https://www.flashscore.com.mx/partido/CvbDaBsg/#/resumen-del-partido', 'event_time': '06.10. 13:00', 'home_team': 'Real Sociedad', 'away_team': 'Atlético de Madrid', 'home_team_score': '1', 'away_team_score': '1', 'summary': [{'team': 'away', 'time': '1', 'event': 'gol', 'main_player': 'Álvarez J.', 'main_player_link': '/jugador/alvarez-julian/bBHauDIC/', 'second_player': 'Griezmann A.', 'second_player_link': '/jugador/griezmann-antoine/OxCa1jdT/'}, {'team': 'home', 'time': '46', 'event': 'substitucion', 'main_player': 'Méndez B.', 'main_player_link': '/jugador/mendez-brais/Ey5XjmJt/', 'second_player': 'López J.', 'second_player_link': '/jugador/lopez-javi/MaufHIJ2/'}, {'team': 'away', 'time': '55', 'event': 'tarjeta_amarilla', 'main_player': 'Lenglet C.', 'main_player_link': '/jugador/lenglet-clement/rH0mL7ws/', 'second_player': '', 'second_player_link': ''}, {'team': 'home', 'time': '61', 'event': 'substitucion', 'main_player': 'Barrenetxea A.', 'main_player_link': '/jugador/barrenetxea-ander/A3vo4Lf6/', 'second_player': 'Becker S.', 'second_player_link': '/jugador/becker-sheraldo/2scm2TO3/'}, {'team': 'away', 'time': '64', 'event': 'substitucion', 'main_player': 'de Paul R.', 'main_player_link': '/jugador/de-paul-rodrigo/AZ6TTjDC/', 'second_player': 'Gallagher C.', 'second_player_link': '/jugador/gallagher-conor/dtbJO8B3/'}, {'team': 'away', 'time': '74', 'event': 'substitucion', 'main_player': 'Sörloth A.', 'main_player_link': '/jugador/sorloth-alexander/QwqgNkTP/', 'second_player': 'Álvarez J.', 'second_player_link': '/jugador/alvarez-julian/bBHauDIC/'}, {'team': 'away', 'time': '80', 'event': 'tarjeta_amarilla', 'main_player': 'Galán J.', 'main_player_link': '/jugador/galan-javier/t8GDN709/', 'second_player': '', 'second_player_link': ''}, {'team': 'away', 'time': '83', 'event': 'substitucion', 'main_player': 'Riquelme R.', 'main_player_link': '/jugador/riquelme-rodrigo/2iQMPvBg/', 'second_player': 'Griezmann A.', 'second_player_link': '/jugador/griezmann-antoine/OxCa1jdT/'}, {'team': 'away', 'time': '83', 'event': 'substitucion', 'main_player': 'Mandava R.', 'main_player_link': '/jugador/mandava-reinildo/zekFd0M8/', 'second_player': 'Galán J.', 'second_player_link': '/jugador/galan-javier/t8GDN709/'}, {'team': 'home', 'time': '84', 'event': 'gol', 'main_player': 'Sucic L.', 'main_player_link': '/jugador/sucic-luka/p6f9CgsE/', 'second_player': 'Oyarzabal M.', 'second_player_link': '/jugador/oyarzabal-mikel/dQ1P695O/'}, {'team': 'away', 'time': '88', 'event': 'tarjeta_amarilla', 'main_player': 'Simeone D. P.', 'main_player_link': '/jugador/simeone-diego-pablo/AZ18LjKN/', 'second_player': '', 'second_player_link': ''}], 'stats': {'full_time': {'Goles esperados (xG)': {'home': '0.93', 'away': '0.39'}, 'Posesión de balón': {'home': '67%', 'away': '33%'}, 'Remates': {'home': '16', 'away': '4'}, 'Remates a puerta': {'home': '7', 'away': '1'}, 'Remates fuera': {'home': '9', 'away': '3'}, 'Remates rechazados': {'home': '0', 'away': '0'}, 'Tiros libres': {'home': '11', 'away': '13'}, 'Córneres': {'home': '5', 'away': '1'}, 'Fueras de juego': {'home': '2', 'away': '2'}, 'Saques de banda': {'home': '19', 'away': '22'}, 'Paradas': {'home': '0', 'away': '6'}, 'Faltas': {'home': '10', 'away': '9'}, 'Tarjetas amarillas': {'home': '0', 'away': '2'}}, 'first_half': {'Goles esperados (xG)': {'home': '0.53', 'away': '0.23'}, 'Posesión de balón': {'home': '62%', 'away': '38%'}, 'Remates': {'home': '8', 'away': '2'}, 'Remates a puerta': {'home': '6', 'away': '1'}, 'Remates fuera': {'home': '2', 'away': '1'}, 'Remates rechazados': {'home': '0', 'away': '0'}, 'Tiros libres': {'home': '2', 'away': '6'}, 'Córneres': {'home': '2', 'away': '1'}, 'Fueras de juego': {'home': '1', 'away': '1'}, 'Saques de banda': {'home': '14', 'away': '14'}, 'Paradas': {'home': '0', 'away': '6'}, 'Faltas': {'home': '4', 'away': '1'}}, 'second_half': {'Goles esperados (xG)': {'home': '0.40', 'away': '0.16'}, 'Posesión de balón': {'home': '72%', 'away': '28%'}, 'Remates': {'home': '8', 'away': '2'}, 'Remates a puerta': {'home': '1', 'away': '0'}, 'Remates fuera': {'home': '7', 'away': '2'}, 'Remates rechazados': {'home': '0', 'away': '0'}, 'Tiros libres': {'home': '9', 'away': '7'}, 'Córneres': {'home': '3', 'away': '0'}, 'Fueras de juego': {'home': '1', 'away': '1'}, 'Saques de banda': {'home': '5', 'away': '8'}, 'Paradas': {'home': '0', 'away': '0'}, 'Faltas': {'home': '6', 'away': '8'}, 'Tarjetas amarillas': {'home': '0', 'away': '2'}}}, 'line_up': {'away': [{'type': 'Alineaciones iniciales', 'number': '13', 'player': 'Oblak J.', 'player_link': 'https://www.flashscore.com.mx/jugador/oblak-jan/SYy8ZHN9', 'country': 'Eslovenia', 'full_name': 'Jan Oblak', 'birthdate': ' 07.01.1993'}, {'type': 'Alineaciones iniciales', 'number': '20', 'player': 'Witsel A.', 'player_link': 'https://www.flashscore.com.mx/jugador/witsel-axel/2JsUqijl', 'country': 'Bélgica', 'full_name': 'Axel Witsel', 'birthdate': ' 12.01.1989'}, {'type': 'Alineaciones iniciales', 'number': '2', 'player': 'Giménez J. M.', 'player_link': 'https://www.flashscore.com.mx/jugador/gimenez-jose-maria/IgRLzKhM', 'country': 'Uruguay', 'full_name': 'José María Giménez', 'birthdate': ' 20.01.1995'}, {'type': 'Alineaciones iniciales', 'number': '15', 'player': 'Lenglet C.', 'player_link': 'https://www.flashscore.com.mx/jugador/lenglet-clement/rH0mL7ws', 'country': 'Francia', 'full_name': 'Clement Lenglet', 'birthdate': ' 17.06.1995'}, {'type': 'Alineaciones iniciales', 'number': '16', 'player': 'Molina N.', 'player_link': 'https://www.flashscore.com.mx/jugador/molina-nahuel/M3TzoLot', 'country': 'Argentina', 'full_name': 'Nahuel Molina', 'birthdate': ' 06.04.1998'}, {'type': 'Alineaciones iniciales', 'number': '8', 'player': 'Barrios P.', 'player_link': 'https://www.flashscore.com.mx/jugador/barrios-pablo/AaZiGJ9E', 'country': 'España', 'full_name': 'Pablo Barrios', 'birthdate': ' 15.06.2003'}, {'type': 'Alineaciones iniciales', 'number': '6', 'player': 'Koke', 'player_link': 'https://www.flashscore.com.mx/jugador/koke/v9hLv1xJ', 'country': 'España', 'full_name': 'Koke', 'birthdate': ' 08.01.1992'}, {'type': 'Alineaciones iniciales', 'number': '4', 'player': 'Gallagher C.', 'player_link': 'https://www.flashscore.com.mx/jugador/gallagher-conor/dtbJO8B3', 'country': 'Inglaterra', 'full_name': 'Conor Gallagher', 'birthdate': ' 06.02.2000'}, {'type': 'Alineaciones iniciales', 'number': '21', 'player': 'Galán J.', 'player_link': 'https://www.flashscore.com.mx/jugador/galan-javier/t8GDN709', 'country': 'España', 'full_name': 'Javi Galán', 'birthdate': ' 19.11.1994'}, {'type': 'Alineaciones iniciales', 'number': '7', 'player': 'Griezmann A.', 'player_link': 'https://www.flashscore.com.mx/jugador/griezmann-antoine/OxCa1jdT', 'country': 'Francia', 'full_name': 'Antoine Griezmann', 'birthdate': ' 21.03.1991'}, {'type': 'Alineaciones iniciales', 'number': '19', 'player': 'Álvarez J.', 'player_link': 'https://www.flashscore.com.mx/jugador/alvarez-julian/bBHauDIC', 'country': 'Argentina', 'full_name': 'Julián Álvarez', 'birthdate': ' 31.01.2000'}, {'type': 'Suplentes', 'number': '10', 'player': 'Correa A.', 'player_link': 'https://www.flashscore.com.mx/jugador/correa-angel/McWkid34', 'country': 'Argentina', 'full_name': 'Ángel Correa', 'birthdate': ' 09.03.1995'}, {'type': 'Suplentes', 'number': '5', 'player': 'de Paul R.', 'player_link': 'https://www.flashscore.com.mx/jugador/de-paul-rodrigo/AZ6TTjDC', 'country': 'Argentina', 'full_name': 'Rodrigo de Paul', 'birthdate': ' 24.05.1994'}, {'type': 'Suplentes', 'number': '31', 'player': 'Gomis A.', 'player_link': 'https://www.flashscore.com.mx/jugador/gomis-antonio/0rBkNdYp', 'country': 'España', 'full_name': 'Antonio Gomis', 'birthdate': ' 20.05.2003'}, {'type': 'Suplentes', 'number': '27', 'player': 'Kostis I.', 'player_link': 'https://www.flashscore.com.mx/jugador/kostis-ilias/QTc0qeb2', 'country': 'Grecia', 'full_name': 'Ilias Kostis', 'birthdate': ' 27.02.2003'}, {'type': 'Suplentes', 'number': '11', 'player': 'Lemar T.', 'player_link': 'https://www.flashscore.com.mx/jugador/lemar-thomas/jX8PENMO', 'country': 'Francia', 'full_name': 'Thomas Lemar', 'birthdate': ' 12.11.1995'}, {'type': 'Suplentes', 'number': '12', 'player': 'Lino S.', 'player_link': 'https://www.flashscore.com.mx/jugador/lino-samuel/vTPgNn01', 'country': 'Brasil', 'full_name': 'Samuel Lino', 'birthdate': ' 23.12.1999'}, {'type': 'Suplentes', 'number': '23', 'player': 'Mandava R.', 'player_link': 'https://www.flashscore.com.mx/jugador/mandava-reinildo/zekFd0M8', 'country': 'Mozambique', 'full_name': 'Reinildo Mandava', 'birthdate': ' 21.01.1994'}, {'type': 'Suplentes', 'number': '1', 'player': 'Musso J.', 'player_link': 'https://www.flashscore.com.mx/jugador/musso-juan/zB5O8dXn', 'country': 'Argentina', 'full_name': 'Juan Musso', 'birthdate': ' 06.05.1994'}, {'type': 'Suplentes', 'number': '17', 'player': 'Riquelme R.', 'player_link': 'https://www.flashscore.com.mx/jugador/riquelme-rodrigo/2iQMPvBg', 'country': 'España', 'full_name': 'Rodrigo Riquelme', 'birthdate': ' 02.04.2000'}, {'type': 'Suplentes', 'number': '22', 'player': 'Simeone G.', 'player_link': 'https://www.flashscore.com.mx/jugador/simeone-giuliano/IJTJu41i', 'country': 'Argentina', 'full_name': 'Giuliano Simeone', 'birthdate': ' 18.12.2002'}, {'type': 'Suplentes', 'number': '9', 'player': 'Sörloth A.', 'player_link': 'https://www.flashscore.com.mx/jugador/sorloth-alexander/QwqgNkTP', 'country': 'Noruega', 'full_name': 'Alexander Sörloth', 'birthdate': ' 05.12.1995'}, {'type': 'Entrenadores', 'number': '', 'player': 'Simeone D. P.', 'player_link': 'https://www.flashscore.com.mx/jugador/simeone-diego-pablo/AZ18LjKN', 'country': 'Argentina', 'full_name': 'Diego Pablo Simeone', 'birthdate': ' 28.04.1970'}], 'home': [{'type': 'Alineaciones iniciales', 'number': '1', 'player': 'Remiro A.', 'player_link': 'https://www.flashscore.com.mx/jugador/remiro-alejandro/UmDjbtRC', 'country': 'España', 'full_name': 'Alex Remiro', 'birthdate': ' 24.03.1995'}, {'type': 'Alineaciones iniciales', 'number': '27', 'player': 'Aramburu J.', 'player_link': 'https://www.flashscore.com.mx/jugador/aranburu-jon/vNTtZiAr', 'country': 'Venezuela', 'full_name': 'Jon Aramburu', 'birthdate': ' 23.07.2002'}, {'type': 'Alineaciones iniciales', 'number': '5', 'player': 'Zubeldia I.', 'player_link': 'https://www.flashscore.com.mx/jugador/zubeldia-igor/phTjGNq0', 'country': 'España', 'full_name': 'Igor Zubeldia', 'birthdate': ' 30.03.1997'}, {'type': 'Alineaciones iniciales', 'number': '21', 'player': 'Aguerd N.', 'player_link': 'https://www.flashscore.com.mx/jugador/aguerd-naif/zsQh7xdD', 'country': 'Marruecos', 'full_name': 'Nayef Aguerd', 'birthdate': ' 30.03.1996'}, {'type': 'Alineaciones iniciales', 'number': '12', 'player': 'López J.', 'player_link': 'https://www.flashscore.com.mx/jugador/lopez-javi/MaufHIJ2', 'country': 'España', 'full_name': 'Javi López', 'birthdate': ' 25.03.2002'}, {'type': 'Alineaciones iniciales', 'number': '14', 'player': 'Kubo T.', 'player_link': 'https://www.flashscore.com.mx/jugador/kubo-takefusa/fqdLdpc3', 'country': 'Japón', 'full_name': 'Takefusa Kubo', 'birthdate': ' 04.06.2001'}, {'type': 'Alineaciones iniciales', 'number': '24', 'player': 'Sucic L.', 'player_link': 'https://www.flashscore.com.mx/jugador/sucic-luka/p6f9CgsE', 'country': 'Croacia', 'full_name': 'Luka Sucic', 'birthdate': ' 08.09.2002'}, {'type': 'Alineaciones iniciales', 'number': '4', 'player': 'Zubimendi M.', 'player_link': 'https://www.flashscore.com.mx/jugador/zubimendi-martin/fNI6Gsdr', 'country': 'España', 'full_name': 'Martín Zubimendi', 'birthdate': ' 02.02.1999'}, {'type': 'Alineaciones iniciales', 'number': '17', 'player': 'Gómez S.', 'player_link': 'https://www.flashscore.com.mx/jugador/gomez-sergio/fmGvlHVM', 'country': 'España', 'full_name': 'Sergio Gómez', 'birthdate': ' 04.09.2000'}, {'type': 'Alineaciones iniciales', 'number': '11', 'player': 'Becker S.', 'player_link': 'https://www.flashscore.com.mx/jugador/becker-sheraldo/2scm2TO3', 'country': 'Surinam', 'full_name': 'Sheraldo Becker', 'birthdate': ' 09.02.1995'}, {'type': 'Alineaciones iniciales', 'number': '10', 'player': 'Oyarzabal M.', 'player_link': 'https://www.flashscore.com.mx/jugador/oyarzabal-mikel/dQ1P695O', 'country': 'España', 'full_name': 'Mikel Oyarzabal', 'birthdate': ' 21.04.1997'}, {'type': 'Suplentes', 'number': '7', 'player': 'Barrenetxea A.', 'player_link': 'https://www.flashscore.com.mx/jugador/barrenetxea-ander/A3vo4Lf6', 'country': 'España', 'full_name': 'Ander Barrenetxea', 'birthdate': ' 27.12.2001'}, {'type': 'Suplentes', 'number': '25', 'player': 'Magunazelaia J.', 'player_link': 'https://www.flashscore.com.mx/jugador/magunazelaia-jon/0IZE0zuH', 'country': 'España', 'full_name': 'Jon Magunazelaia', 'birthdate': ' 13.07.2001'}, {'type': 'Suplentes', 'number': '28', 'player': 'Marín P.', 'player_link': 'https://www.flashscore.com.mx/jugador/marin-pablo/Ye976xiA', 'country': 'España', 'full_name': 'Pablo Marín', 'birthdate': ' 03.07.2003'}, {'type': 'Suplentes', 'number': '13', 'player': 'Marrero U.', 'player_link': 'https://www.flashscore.com.mx/jugador/marrero-unai/Wr5ZTIf7', 'country': 'España', 'full_name': 'Unai Marrero', 'birthdate': ' 09.10.2001'}, {'type': 'Suplentes', 'number': '31', 'player': 'Martín J.', 'player_link': 'https://www.flashscore.com.mx/jugador/martin-jon/dd9n67gb', 'country': 'España', 'full_name': 'Jon Martín', 'birthdate': ' 23.04.2006'}, {'type': 'Suplentes', 'number': '23', 'player': 'Méndez B.', 'player_link': 'https://www.flashscore.com.mx/jugador/mendez-brais/Ey5XjmJt', 'country': 'España', 'full_name': 'Brais Méndez', 'birthdate': ' 07.01.1997'}, {'type': 'Suplentes', 'number': '3', 'player': 'Muñoz A.', 'player_link': 'https://www.flashscore.com.mx/jugador/munoz-aihen/C8QkouJU', 'country': 'España', 'full_name': 'Aihen Muñoz', 'birthdate': ' 16.08.1997'}, {'type': 'Suplentes', 'number': '2', 'player': 'Odriozola A.', 'player_link': 'https://www.flashscore.com.mx/jugador/odriozola-alvaro/0zO9SfkA', 'country': 'España', 'full_name': 'Alvaro Odriozola', 'birthdate': ' 14.12.1995'}, {'type': 'Suplentes', 'number': '16', 'player': 'Olasagasti J. A.', 'player_link': 'https://www.flashscore.com.mx/jugador/olasagasti-jon/O8nKKpaP', 'country': 'España', 'full_name': 'Jon Ander Olasagasti', 'birthdate': ' 16.08.2000'}, {'type': 'Suplentes', 'number': '9', 'player': 'Oskarsson O.', 'player_link': 'https://www.flashscore.com.mx/jugador/oskarsson-orri-steinn/K2gCwDJE', 'country': 'Islandia', 'full_name': 'Orri Oskarsson', 'birthdate': ' 29.08.2004'}, {'type': 'Suplentes', 'number': '20', 'player': 'Pacheco J.', 'player_link': 'https://www.flashscore.com.mx/jugador/pacheco-jon/Qk9dJWGB', 'country': 'España', 'full_name': 'Jon Pacheco', 'birthdate': ' 08.01.2001'}, {'type': 'Suplentes', 'number': '19', 'player': 'Sadiq U.', 'player_link': 'https://www.flashscore.com.mx/jugador/sadiq-umar/UsKF9Yzn', 'country': 'Nigeria', 'full_name': 'Umar Sadiq', 'birthdate': ' 02.02.1997'}, {'type': 'Entrenadores', 'number': '', 'player': 'Alguacil I.', 'player_link': 'https://www.flashscore.com.mx/jugador/alguacil-imanol/IJEltJ2H', 'country': 'España', 'full_name': 'Imanol Alguacil', 'birthdate': ' 04.07.1971'}]}, 'comments': [{'title': '90+5', 'details': 'El encuentro acaba de finalizar.'}, {'title': '90+5', 'details': 'Takefusa Kubo supera a la defensa con un magnífico pase por alto que recibe Brais Méndez (Real Sociedad), pero no logra cabecear a puerta. El balón se marcha por el poste izquierdo.'}, {'title': '90+2', 'details': 'Mikel Oyarzabal (Real Sociedad) ha estado a punto de anotar tras recibir un buen pase alto de Sergio Gómez y conectar un cabezazo desde cerca desviado del palo derecho.'}, {'title': '90+1', 'details': 'Takefusa Kubo (Real Sociedad) crea una gran oportunidad y dispara a puerta desde media distancia, pero el balón sale por muy poco por encima del larguero.'}, {'title': '90+1', 'details': 'Rodrigo Riquelme (Atlético de Madrid) envía un pase raso desde fuera del área a Pablo Barrios. Logra disparar, pero la defensa logra interceptar el balón en el último momento.'}, {'title': '90', 'details': 'Se añadirán 5 minutos de prolongación.'}, {'title': '88', 'details': 'El árbitro Isidro Díaz de Mera no tolera más protestas de Diego Pablo Simeone y le muestra tarjeta amarilla.'}, {'title': '88', 'details': 'Rodrigo Riquelme (Atlético de Madrid) envía un centro bombeado en un tiro libre de media distancia, pero se va fuera. El balón ha salido y habrá saque de puerta para Real Sociedad.'}, {'title': '87', 'details': 'Falta absurda de Jon Aramburu (Real Sociedad) señalada por Isidro Díaz de Mera. Es tiro libre a favor de Atlético de Madrid.'}, {'title': '84', 'details': 'Falta absurda de Jon Aramburu (Real Sociedad) señalada por Isidro Díaz de Mera. Es tiro libre a favor de Atlético de Madrid.'}, {'title': '83', 'details': 'Diego Pablo Simeone decide hacer un cambio para dinamizar el juego de su equipo. Javi Galán sale del terreno de juego y es sustituido por Reinildo Mandava (Atlético de Madrid).'}, {'title': '83', 'details': 'Cambio. Rodrigo Riquelme (Atlético de Madrid) ha entrado en sustitución de Antoine Griezmann.'}, {'title': '82', 'details': 'El árbitro principal y su asistente señalan el banderín de córner. Ocasión para Real Sociedad de poner en peligro la meta rival.'}, {'title': '82', 'details': 'La asistencia al partido de hoy es de 31983 espectadores.'}, {'title': '82', 'details': 'Sergio Gómez (Real Sociedad) bota un córner, pero no encuentra la cabeza de ningún compañero, y la defensa despeja. Córner señalado a favor de Real Sociedad. El árbitro principal y uno de sus asistentes señalan el banderín de córner.'}, {'title': '81', 'details': 'Sergio Gómez (Real Sociedad) lanza el tiro libre colgando el balón al área, pero su envío es fácilmente despejado por el primer defensor. El árbitro asistente señala el banderín de córner. Saque de esquina para Real Sociedad.'}, {'title': '80', 'details': 'Tarjeta amarilla merecida. La entrada de Javi Galán (Atlético de Madrid) fue bastante dura y Isidro Díaz de Mera no dudó en sacarle la amarilla.'}, {'title': '78', 'details': 'Ander Barrenetxea (Real Sociedad) llega a un centro de Martín Zubimendi, pero no consigue cabecear a puerta. El balón rebasa el larguero.'}, {'title': '77', 'details': 'Se interrumpe el juego. Rodrigo de Paul (Atlético de Madrid) ha sufrido un golpe y recibirá asistencia.'}, {'title': '74', 'details': 'Se efectúa un cambio. Sale Julián Álvarez y entra Alexander Sörloth (Atlético de Madrid).'}, {'title': '72', 'details': 'Mísil de Luka Sucic (Real Sociedad) desde el borde del área. Se escapa sólo unos centímetros por encima del travesaño.'}, {'title': '71', 'details': 'Remates totales: 10:4. Remates a puerta en lo que va de encuentro: 7:1.'}, {'title': '68', 'details': 'Jon Aramburu (Real Sociedad) centra al área, pero Jan Oblak sale de la meta y atrapa el balón.'}, {'title': '66', 'details': 'Ander Barrenetxea (Real Sociedad) intenta marcar con un cabezazo cerca del punto de penalti dirigido a la escuadra izquierda. Jan Oblak, con grandes reflejos, para con comodidad.'}, {'title': '64', 'details': 'Llega un cambio. Se retirará del terreno de juego Conor Gallagher. Diego Pablo Simeone da las últimas instrucciones a Rodrigo de Paul (Atlético de Madrid).'}, {'title': '61', 'details': 'Final del partido para Sheraldo Becker, sustituido por Ander Barrenetxea (Real Sociedad).'}, {'title': '61', 'details': '¡Gran ocasión desperdiciada por Conor Gallagher (Atlético de Madrid)! Controló el balón tras un buen pase raso y disparó a puerta desde una distancia peligrosa, pero el balón salió muy desviado del poste derecho.'}, {'title': '57', 'details': 'Nahuel Molina (Atlético de Madrid) erra una clara ocasión voleando por encima del larguero.'}, {'title': '56', 'details': 'Pablo Barrios (Atlético de Madrid) centra al área, pero el balón pasa muy cerca de Alex Remiro, que consigue blocar.'}, {'title': '55', 'details': 'Tarjeta amarilla merecida para Clement Lenglet (Atlético de Madrid).'}, {'title': '53', 'details': 'Cae Mikel Oyarzabal (Real Sociedad) tras recibir una entrada dentro del área, pero el árbitro desoye las protestas de los jugadores.'}, {'title': '50', 'details': 'Alex Remiro se anticipa para interceptar un pase en largo de Javi Galán (Atlético de Madrid).'}, {'title': '48', 'details': 'Jugada a balón parado. Sergio Gómez (Real Sociedad) saca hacia el área, pero el balón es despejado.'}, {'title': '47', 'details': 'Isidro Díaz de Mera pita falta de Clement Lenglet (Atlético de Madrid). Real Sociedad fuerza un tiro libre.'}, {'title': '47', 'details': 'Sergio Gómez (Real Sociedad) saca el tiro libre y centra al área, pero la defensa logra despejar. Takefusa Kubo (Real Sociedad) se lleva las manos a la cabeza tras errar una gran ocasión. Llegó a un rechace y disparó desde el borde del área muy desviado del poste derecho.'}, {'title': '46', 'details': 'Isidro Díaz de Mera pita y señala falta de Clement Lenglet (Atlético de Madrid) por derribar a un oponente. Tiro libre para Real Sociedad. Puede seguir aproximándose a la portería.'}, {'title': '46', 'details': 'Imanol Alguacil hace un cambio tras el primer tiempo. Brais Méndez entra en sustitución de Javi López (Real Sociedad).'}, {'title': '46', 'details': 'Terminó el descanso, y los jugadores ya han saltado al césped. Comienza el segundo tiempo.'}, {'title': '45+1', 'details': 'El árbitro pita el final de la primera parte y ambos equipos se dirigen a los vestuarios.'}, {'title': '45', 'details': 'El cuarto árbitro indica que se añadirán 1 minutos.'}, {'title': '45', 'details': 'Martín Zubimendi (Real Sociedad) envía un balón largo a Sheraldo Becker, pero va demasiado fuerte y la jugada termina en nada. El balón sale por la línea de fondo y Atlético de Madrid sacará de puerta.'}, {'title': '43', 'details': 'Nayef Aguerd (Real Sociedad) envía un balón largo a Takefusa Kubo, pero va demasiado fuerte y la jugada termina en nada. El balón sale por la línea de fondo y Atlético de Madrid sacará de puerta.'}, {'title': '43', 'details': 'Sergio Gómez (Real Sociedad) saca de esquina y manda el balón al área, pero un defensor se anticipa e intercepta el envío.'}, {'title': '42', 'details': 'Takefusa Kubo (Real Sociedad) se deshace de la oposición defensiva con facilidad y no logra anotar en un mano a mano con el portero. Jan Oblak detiene bien su disparo dirigido a la esquina inferior derecha.'}, {'title': '38', 'details': 'Isidro Díaz de Mera detiene el juego. Falta táctica de Conor Gallagher (Atlético de Madrid).'}, {'title': '38', 'details': 'El córner lanzado por Antoine Griezmann (Atlético de Madrid) se queda en nada. La defensa está atenta y consigue despejar.'}, {'title': '37', 'details': 'Antoine Griezmann (Atlético de Madrid) envía un pase raso al área, pero la defensa rival logra sacar el balón fuera. El balón sale fuera y habrá córner. Atlético de Madrid puede continuar su ataque.'}, {'title': '34', 'details': 'Takefusa Kubo (Real Sociedad) manda un buen centro bombeado al área. La defensa está atenta y logra despejar el balón.'}, {'title': '34', 'details': 'Sergio Gómez (Real Sociedad) saca el córner, y el balón termina siendo despejado por un defensor.'}, {'title': '33', 'details': 'Sergio Gómez (Real Sociedad) envía un magnífico pase dentro del área, pero el balón es interceptado y despejado por la defensa. Córner para Real Sociedad.'}, {'title': '30', 'details': 'Takefusa Kubo (Real Sociedad) se zafa de los contrarios, pero envía un pase demasiado fuerte a Jon Aramburu. El balón sale por la línea de fondo y Atlético de Madrid sacará de puerta.'}, {'title': '27', 'details': 'Martín Zubimendi (Real Sociedad) intenta encontrar a un compañero con un centro que la defensa logra interceptar.'}, {'title': '26', 'details': 'Mikel Oyarzabal (Real Sociedad) recibe un pase preciso y logra conectar un buen disparo hacia la esquina inferior izquierda. Jan Oblak adivina la trayectoria y detiene con una gran parada.'}, {'title': '23', 'details': 'Javi López (Real Sociedad) intenta anotar desde larga distancia, pero su disparo se va alto por encima del travesaño.'}, {'title': '20', 'details': 'Jon Aramburu (Real Sociedad) intenta desmarcarse, pero su control no es bueno y pierde el balón. El balón ha salido y habrá saque de puerta para Atlético de Madrid.'}, {'title': '18', 'details': 'Tras recibir un pase preciso, Jon Aramburu (Real Sociedad) decide probar suerte con un duro disparo de larga distancia bien dirigido a la esquina inferior izquierda, pero Jan Oblak tiene una visión clara y hace una cómoda parada.'}, {'title': '13', 'details': 'Igor Zubeldia (Real Sociedad) se libra de su marcador y culmina un córner con un remate de cabeza a la parte inferior del larguero que es detenido brillantemente por el portero. ¡Sensacional parada de Jan Oblak! Nayef Aguerd (Real Sociedad) aprovechó un rechace dentro del área para hacer un disparo centrado, pero el balón terminó en los guantes del portero.'}, {'title': '12', 'details': 'Saque de esquina. Sergio Gómez (Real Sociedad) se prepara para enviar el balón al área.'}, {'title': '12', 'details': 'Sheraldo Becker (Real Sociedad) manda un pase dentro del área, pero el balón es interceptado y despejado. El árbitro pita córner a favor de Real Sociedad.'}, {'title': '11', 'details': 'Cae Julián Álvarez (Atlético de Madrid) tras recibir una entrada dentro del área, pero el árbitro desoye las protestas de los jugadores.'}, {'title': '9', 'details': 'Sheraldo Becker (Real Sociedad) se precipita en su desmarque y el colegiado señala fuera de juego.'}, {'title': '6', 'details': 'Julián Álvarez (Atlético de Madrid) se hace con el balón y conecta un disparo desde el borde del área que se va alto por encima del larguero.'}, {'title': '5', 'details': 'Igor Zubeldia (Real Sociedad) recibe un pase preciso y encuentra espacio para disparar a puerta. El portero está atento y detiene su disparo lejano dirigido a la esquina inferior izquierda.'}, {'title': '4', 'details': 'Sheraldo Becker (Real Sociedad) mete un centro, pero el balón es despejado por uno de los defensas.'}, {'title': '1', 'details': 'Sheraldo Becker (Real Sociedad) mete un centro, pero el balón es despejado por uno de los defensas.'}, {'title': '1', 'details': 'Comienza la primera parte.'}, {'title': '', 'details': 'Atlético de Madrid hará el saque inicial.'}, {'title': '', 'details': 'Isidro Díaz de Mera es el árbitro designado para este encuentro.'}, {'title': '', 'details': 'Ya están disponibles los onces iniciales de ambos equipos. Pueden consultarlos aquí mismo.'}, {'title': '', 'details': 'Bienvenidos a nuestros comentarios en directo. Intentaremos ofrecerles una descripción detallada de lo que suceda en el terreno de juego. El partido comenzará dentro de unos momentos.'}]
    }

class excelwriter():
  def __init__(self) -> None:
    self.workbook = xlsxwriter.Workbook('results.xlsx')
    self.bold = self.workbook.add_format({'bold': True})
    self.center = self.workbook.add_format()
    self.center.set_align('center')
    self.center.set_align('vcenter')
    self.merge_format_subtitle= self.workbook.add_format({
      "bold": 1,
      "border": 1,
      "align": "center",
      "valign": "vcenter",
      "fg_color": "blue",
      "font_color": "white"
    })
    self.detail_comment = self.workbook.add_format({
      "valign": "vcenter",
      "text_wrap": True
    })
    self.subtitle = self.workbook.add_format({
      "bold": 1,
      "align": "center",
      "valign": "vcenter",
    })

  def create_ws(self, id):
    self.ws = self.workbook.add_worksheet(id)
    self.ws.set_column_pixels(0,0,105)
    self.ws.set_column_pixels(1,1,530)
    self.ws.set_column_pixels(2,2,200)
    self.ws.set_column_pixels(3,3,170)
    self.ws.set_column_pixels(4,4,80)
    
  def fill_general_details(self, json_data):
    self.away = json_data['away_team']
    self.home = json_data['home_team']
    self.ws.write('A1', 'Jornada 9 - Fecha', self.center)
    self.ws.write('B1', json_data['event_time'])
    self.ws.write('B2', self.home, self.center)
    self.ws.write('C2', 'vs', self.center)
    self.ws.write('D2', self.away, self.center)
    self.ws.write('A3', 'Resultado', self.center)
    self.ws.write('B3', json_data['home_team_score'], self.center)
    self.ws.write('D3', json_data['away_team_score'], self.center)
  
  def fill_summary(self, summary_data):
    self.ws.merge_range("A5:D5", "RESUMEN", self.merge_format_subtitle)
    row = 6
    for item in summary_data:
      self.ws.write('A'+str(row), item['time']+'min', self.center)
      if item['team'] == 'away':
        self.ws.write('B'+str(row), self.away, self.center)
      else:
        self.ws.write('B'+str(row), self.home, self.center)
      if item['event'] == 'gol':
        self.ws.write('C'+str(row), 'Gol de: '+item['main_player'], self.center)
        if item['second_player'] != '':
          self.ws.write('D'+str(row), 'Asistido por: '+item['second_player'], self.center)
      elif item['event'] == 'substitucion':
        self.ws.write('C'+str(row), 'Entra: '+item['main_player'], self.center)
        self.ws.write('D'+str(row), 'Por: '+item['second_player'], self.center)
      elif item['event'] == 'penalti_fallado':
        self.ws.write('C'+str(row), 'Penalti Fallado por: '+item['main_player'], self.center)
      elif item['event'] == 'tarjeta_amarilla':
        self.ws.write('C'+str(row), 'T. amarilla para: '+item['main_player'], self.center)
      elif item['event'] == 'tarjeta_roja':
        self.ws.write('C'+str(row), 'T. roja para: '+item['main_player'], self.center)
      elif item['event'] == '2da_tarjeta_amarilla':
        self.ws.write('C'+str(row), '2da T. amarilla para: '+item['main_player'], self.center)
      elif item['event'] == 'gol_anulado_offside':
        self.ws.write('C'+str(row), 'Gol anulado por fuera de juego de: '+item['main_player'], self.center)
      row = row + 1
    return row

  def fill_stats(self, stats, row):
    for k, v in stats.items():
      if k == 'full_time':
        title = 'Todo el partido'
      elif k == 'first_half':
        title = '1er tiempo'
      elif k == 'second_half':
        title = '2do tiempo'
      self.ws.merge_range("A"+str(row)+":C"+str(row)+"", "ESTADISTICAS "+title, self.merge_format_subtitle)
      row = row + 1
      for t, val in v.items():
        self.ws.write('A'+str(row), val['home'], self.center)
        self.ws.write('B'+str(row), t, self.subtitle)
        self.ws.write('C'+str(row), val['away'], self.center)
        row = row + 1
    return row
  
  def loop_lineup(self, team, row):
    for idx, item in enumerate(team):
      self.ws.write('A'+str(row), item['number'], self.center)
      self.ws.write('B'+str(row), item['full_name'], self.center)
      if 'birthdate' in item:
        self.ws.write('C'+str(row), item['birthdate'], self.center)
      self.ws.write('D'+str(row), item['country'], self.center)
      if item['type'] == 'Alineaciones iniciales':
        detail = '11 inicial'
      elif item['type'] == 'Suplentes':
        detail = 'Suplente'
      elif item['type'] == 'Jugadores ausentes':
        detail = 'No convocado'
      elif item['type'] == 'Entrenadores':
        detail = 'Entrenador'
      self.ws.write('E'+str(row), detail, self.center)
      row = row + 1
    return row
      
  def fill_lineup(self, lineup, row):
    self.ws.merge_range("A"+str(row)+":E"+str(row)+"", "ALINEACION - "+self.home, self.merge_format_subtitle)
    row = row + 1
    self.ws.write('A'+str(row), 'Numero', self.subtitle)
    self.ws.write('B'+str(row), 'Nombre Completo', self.subtitle)    
    self.ws.write('C'+str(row), 'Fecha Nacimiento', self.subtitle)
    self.ws.write('D'+str(row), 'Pais', self.subtitle)
    self.ws.write('E'+str(row), 'Detalle', self.subtitle)
    row = row + 1
    row = self.loop_lineup(lineup['home'], row)
    self.ws.merge_range("A"+str(row)+":E"+str(row)+"", "ALINEACION - "+self.away, self.merge_format_subtitle)
    row = row + 1
    self.ws.write('A'+str(row), 'Numero', self.subtitle)
    self.ws.write('B'+str(row), 'Nombre Completo', self.subtitle)
    self.ws.write('C'+str(row), 'Fecha Nacimiento', self.subtitle)
    self.ws.write('D'+str(row), 'Pais', self.subtitle)
    self.ws.write('E'+str(row), 'Detalle', self.subtitle)
    row = row + 1
    row = self.loop_lineup(lineup['away'], row)
    return row
      
  def fill_comments(self, comments, row):
    self.ws.merge_range("A"+str(row)+":B"+str(row)+"", "COMENTARIOS", self.merge_format_subtitle)
    row = row + 1
    for item in comments:
      if item['title'] != '':
        self.ws.write('A'+str(row), item['title']+'min', self.center)
      else:
        self.ws.write('A'+str(row), item['title'], self.center)
      self.ws.write('B'+str(row), item['details'], self.detail_comment)
      row = row + 1
    
# test_data = generate_test_data()

# writer = excelwriter()
# writer.create_ws(test_data['id'])
# writer.fill_general_details(test_data)
# row = writer.fill_summary(test_data['summary'])
# row = writer.fill_stats(test_data['stats'], row)
# row = writer.fill_lineup(test_data['line_up'], row)
# writer.fill_comments(test_data['comments'], row)
# writer.workbook.close()